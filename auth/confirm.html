<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>メール確認中...</title>
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>
</head>
<body>
  <h1>メール確認中...</h1>
  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const token = urlParams.get('token');
    const type = urlParams.get('type'); // 一般是 'signup'

    const supabase = supabase.createClient(
      'https://iwdyzfsunnyqcwipttql.supabase.co',
      '你的PUBLIC_ANON_KEY'
    );

    async function confirmEmail() {
      if (!token || !type) {
        alert("トークン情報が不足しています。");
        return;
      }

      const { data, error } = await supabase.auth.verifyOtp({
        type: 'signup',
        token: token
      });

      if (error) {
        alert('確認失敗: ' + error.message);
        console.error(error);
      } else {
        alert('確認成功！ログインしてください。');
        // 可选：跳转到 login 页面
        window.location.href = "/bm-big-management/auth/login.html";
      }
    }

    confirmEmail();
  </script>
</body>
</html>
